{"ast":null,"code":"import _classCallCheck from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/alex/ubunta/gt-desk/Desktop-GT/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/alex/ubunta/gt-desk/Desktop-GT/src/components/DriversEditAddDelete.jsx\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { setDriverAddEditFlag, getDriversList, deleteDriver } from \"../redux/countersAC\"; // import '../css/driversEditAddDelete.css';\n// import '../css/main.css';\n\nvar DriversEditAddDelete =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DriversEditAddDelete, _Component);\n\n  function DriversEditAddDelete() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, DriversEditAddDelete);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DriversEditAddDelete)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.getId = function (e) {\n      return e.target.parentNode.parentNode.getAttribute('id');\n    };\n\n    _this.getEditId = function (e) {\n      var id = e.target.parentNode.parentNode.parentNode.getAttribute('id');\n\n      _this.props.dispatch(setDriverAddEditFlag(Number(id)));\n\n      return id;\n    };\n\n    _this.getDrivers = function () {\n      // e.preventDefault();\n      var that = _assertThisInitialized(_assertThisInitialized(_this)); // сохраняет контекст?!\n\n\n      var url = 'http://178.159.45.189/api/rest-auth/user/drivers/'; // for (var [key, value] of formData.entries()) {\n      //     if (value[0] == '+') {\n      //         user.phone = value\n      //         console.log(key)\n      //         console.log(\"THIS IS TELEFHONE\")\n      //     } else if (key == 'password') {\n      //         user.password = value\n      //         console.log(key)\n      //         console.log(\"THIS IS PASSWORD\")\n      //     } else {\n      //         user.email = value\n      //         console.log(key)\n      //         console.log(\"THIS IS EMAIL\")\n      //     }\n      // }\n      // console.log(\"USER:   \", user)\n      // debugger\n\n      console.log(that.props.store.token);\n      fetch(url, {\n        method: \"GET\",\n        headers: {\n          \"Authorization\": 'JWT ' + that.props.store.user.token,\n          \"Content-Type\": \"application/json\" // ,body: JSON.stringify(user),\n\n        }\n      }).then(function (response) {\n        if (response.status !== 200) {\n          console.log('Looks like there was a problem. Status Code: ' + response.status);\n        }\n\n        console.log(response);\n        return response.json();\n      }).then(function (data) {\n        // debugger\n        that.props.dispatch(getDriversList(data)); // записываю в глобальный стэйт\n\n        console.log(\"DATA: \", data); // let nextLocation = data.user.user_type == 3 ? '/admin/activeOrders' : '/createOrder/selectDate' ;\n        // that.props.history.push(nextLocation) // Переход на страницы админ/пользователь \n      }); // .catch(function (err) {\n      //     console.log('Fetch Error :-S', err);\n      // });\n    };\n\n    _this.submit = function (e) {\n      _this.props.props.history.push(\"/admin/driversEditAddDelete\");\n\n      var id = _this.getId(e);\n\n      console.log(id);\n\n      var that = _assertThisInitialized(_assertThisInitialized(_this));\n\n      var url = \"http://178.159.45.189/api/rest-auth/user/drivers/\".concat(id);\n      var url2 = 'http://178.159.45.189/api/rest-auth/user/drivers/';\n      var token = that.props.store.user.token;\n      console.log(token);\n      fetch(url, {\n        method: \"DELETE\",\n        headers: {\n          \"Authorization\": 'JWT ' + token,\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(function (response) {\n        console.log(response);\n        console.log('delete in DB');\n\n        if (response.status === 200 || response.status === 204) {\n          that.props.dispatch(deleteDriver(Number(id)));\n          console.log('delete in Redux');\n        } else {\n          console.log('Looks like there was a problem. Status Code: ' + response.status);\n        }\n      });\n    };\n\n    _this.setStateAddNewDriver = function (e) {\n      var flag = -1;\n\n      _this.props.dispatch(setDriverAddEditFlag(flag));\n    };\n\n    return _this;\n  }\n\n  _createClass(DriversEditAddDelete, [{\n    key: \"createDriverItem\",\n    value: function createDriverItem(drivers) {\n      var _this2 = this;\n\n      console.log(drivers);\n      return drivers.map(function (driver) {\n        var last_name = driver.last_name,\n            first_name = driver.first_name,\n            patronymic = driver.patronymic,\n            autos = driver.autos,\n            stateNumber = driver.stateNumber,\n            phone = driver.phone,\n            id = driver.id; // пофиксить транспорт!!!!!\n\n        return React.createElement(\"div\", {\n          key: id,\n          id: id,\n          className: \"driver-item\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, \" \\u0418\\u043C\\u044F: \", React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, \" \", last_name, \" \", first_name, \" \", patronymic, \" \")), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \" \\u0417\\u0430\\u043A\\u0440\\u0435\\u043F\\u043B\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0442\\u0440\\u0430\\u043D\\u0441\\u043F\\u043E\\u0440\\u0442: \", React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \" \", autos.title_autos, \" \"), \" \"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, \" \\u0413\\u043E\\u0441. \\u043D\\u043E\\u043C\\u0435\\u0440: \", React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        }, \" \", autos.number_autos, \" \"), \" \"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \" \\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430: \", React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, \" \", phone, \" \"), \" \"), React.createElement(\"div\", {\n          className: \"buttons\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: {\n            pathname: 'newDriver'\n          },\n          className: \"colorWhite\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn\",\n          onClick: _this2.getEditId,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\")), React.createElement(\"button\", {\n          type: \"button\",\n          className: \"btn\",\n          onClick: _this2.submit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, \" \\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \")), React.createElement(\"hr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }));\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getDrivers();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var drivers = this.props.drivers;\n      var driverItems = this.createDriverItem(drivers);\n      return React.createElement(\"div\", {\n        className: \"main-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"drivers-edit-add-delete\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \" \\u0412\\u041E\\u0414\\u0418\\u0422\\u0415\\u041B\\u0418 \"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"drivers\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(Link, {\n        to: {\n          pathname: 'newDriver'\n        },\n        className: \"colorWhite\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        type: \"button\",\n        className: \"btn\",\n        onClick: this.setStateAddNewDriver,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044F\")), driverItems)));\n    }\n  }]);\n\n  return DriversEditAddDelete;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  console.log(state, \"             Driver\");\n  return {\n    store: state.store,\n    drivers: state.store.drivers\n  };\n};\n\nexport default connect(mapStateToProps)(DriversEditAddDelete);","map":{"version":3,"sources":["/home/alex/ubunta/gt-desk/Desktop-GT/src/components/DriversEditAddDelete.jsx"],"names":["React","Component","Link","connect","setDriverAddEditFlag","getDriversList","deleteDriver","DriversEditAddDelete","getId","e","target","parentNode","getAttribute","getEditId","id","props","dispatch","Number","getDrivers","that","url","console","log","store","token","fetch","method","headers","user","then","response","status","json","data","submit","history","push","url2","setStateAddNewDriver","flag","drivers","map","driver","last_name","first_name","patronymic","autos","stateNumber","phone","title_autos","number_autos","pathname","driverItems","createDriverItem","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport { Link } from 'react-router-dom'\nimport { connect } from 'react-redux';\nimport { setDriverAddEditFlag, getDriversList, deleteDriver } from \"../redux/countersAC\";\n\n// import '../css/driversEditAddDelete.css';\n// import '../css/main.css';\n\nclass DriversEditAddDelete extends Component {\n\n\tgetId = (e) => {\n\t\treturn e.target.parentNode.parentNode.getAttribute('id');\n\t}\n\n\tgetEditId = (e) => {\n\t\tlet id = e.target.parentNode.parentNode.parentNode.getAttribute('id');\n\t\tthis.props.dispatch(setDriverAddEditFlag(Number(id)));\n\t\treturn id;\n\t}\n\n\tgetDrivers = () => {\n         // e.preventDefault();\n        const that = this  // сохраняет контекст?!\n\n        const url = 'http://178.159.45.189/api/rest-auth/user/drivers/'\n       \n        // for (var [key, value] of formData.entries()) {\n        //     if (value[0] == '+') {\n        //         user.phone = value\n        //         console.log(key)\n        //         console.log(\"THIS IS TELEFHONE\")\n        //     } else if (key == 'password') {\n        //         user.password = value\n        //         console.log(key)\n        //         console.log(\"THIS IS PASSWORD\")\n        //     } else {\n        //         user.email = value\n        //         console.log(key)\n        //         console.log(\"THIS IS EMAIL\")\n        //     }\n        // }\n        // console.log(\"USER:   \", user)\n        // debugger\n        console.log(that.props.store.token)\n        fetch(url, {\n            method: \"GET\",\n            headers: {\n                \"Authorization\": 'JWT ' + that.props.store.user.token,\n                \"Content-Type\": \"application/json\"\n            }\n            // ,body: JSON.stringify(user),\n        }).then(\n            function (response) {\n                if (response.status !== 200) {\n                    console.log('Looks like there was a problem. Status Code: ' +\n                        response.status);\n                }\n                console.log(response)\n                return response.json();\n            })\n            .then(function (data) {\n                // debugger\n                that.props.dispatch(getDriversList(data)); // записываю в глобальный стэйт\n                console.log(\"DATA: \", data);\n                // let nextLocation = data.user.user_type == 3 ? '/admin/activeOrders' : '/createOrder/selectDate' ;\n                // that.props.history.push(nextLocation) // Переход на страницы админ/пользователь \n            })\n        // .catch(function (err) {\n        //     console.log('Fetch Error :-S', err);\n        // });\n\n    }\n\n\tsubmit = (e) => {\n\t\tthis.props.props.history.push(\"/admin/driversEditAddDelete\");\n\t\tconst id = this.getId(e);\n\n\t\tconsole.log(id)\n\n        const that = this\n\n        const url = `http://178.159.45.189/api/rest-auth/user/drivers/${id}`;\n        const url2 = 'http://178.159.45.189/api/rest-auth/user/drivers/';\n        const token = that.props.store.user.token;\n        console.log(token)\n\n        fetch(url, {\n            method: \"DELETE\",\n            headers: {\n                \"Authorization\": 'JWT ' + token\n                ,\"Content-Type\": \"application/json\"\n            }\n        }).then((response) => {\n              \t\n              \t\tconsole.log(response)\n                \tconsole.log('delete in DB')\n\t        \n\t\t\t        if(response.status === 200 || response.status === 204 ) {\n\t\t\t        \t\n\t\t\t        \tthat.props.dispatch(deleteDriver(Number(id)));\n\n\t\t\t        \tconsole.log('delete in Redux')\n\n\n\t\t\t        } else {\n\t\t\t        \tconsole.log('Looks like there was a problem. Status Code: ' +\n                        response.status);\n\t\t\t        }\n            })\n\t}\n\n\tsetStateAddNewDriver = (e) => {\n\t\tconst flag = -1;\n\t\tthis.props.dispatch(setDriverAddEditFlag(flag));\n\t}\n\n\n\tcreateDriverItem (drivers) {\n\t\tconsole.log(drivers)\n\t\treturn drivers.map((driver) => {\n\t\t\tconst {last_name, first_name, patronymic, autos, stateNumber, phone, id} = driver; // пофиксить транспорт!!!!!\n\t\t\treturn (\n\n\t\t\t\t<div key={id} id={id} className='driver-item'>\n\t\t\t\t\t<p> Имя: <b> {last_name} {first_name} {patronymic} </b></p> \n\t\t\t\t\t<p> Закрепленный транспорт: <b> {autos.title_autos} </b> </p> \n\t\t\t\t\t<p> Гос. номер: <b> {autos.number_autos} </b> </p> \n\t\t\t\t\t<p> Номер телефона: <b> {phone} </b> </p> \n\t\t\t\t\t<div className='buttons'>\n\t\t\t\t\t\t<Link to={{ pathname: 'newDriver' }} className=\"colorWhite\" ><button type='button' className='btn' onClick={this.getEditId}>Редактировать</button></Link>\n\t\t\t\t\t\t<button type='button' className='btn' onClick = {this.submit}> Удалить </button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<hr />\n\t\t\t\t</div>\n\t\t\t)\n\t\t})\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getDrivers();\n\t}\n\n\trender() {\n\t\tconst drivers = this.props.drivers;\n\t\tconst driverItems = this.createDriverItem(drivers);\n\n\t\treturn (\n\t\t\t<div className = 'main-container'>\n\t\t\t\t<div className = 'drivers-edit-add-delete'>\n\t\t\t\t\t<p> ВОДИТЕЛИ </p>\n\t\t\t\t\t<hr/>\n\t\t\t\t\t<div className='drivers'>\n\t\t\t\t\t\t<Link to={{ pathname: 'newDriver' }} className=\"colorWhite\" ><button type='button' className='btn' onClick={this.setStateAddNewDriver}>Добавить водителя</button></Link>\n\t\t\t\t\t\t{driverItems}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nconst mapStateToProps = function (state) {\n\tconsole.log(state, \"             Driver\")\n    return {\n        store: state.store,\n        drivers: state.store.drivers\n    };\n};\n\nexport default connect(mapStateToProps)(DriversEditAddDelete);"]},"metadata":{},"sourceType":"module"}